"use strict";(self.webpackChunk_rnx_kit_docsite=self.webpackChunk_rnx_kit_docsite||[]).push([[5304],{6876:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>l,contentTitle:()=>i,default:()=>p,frontMatter:()=>a,metadata:()=>t,toc:()=>c});const t=JSON.parse('{"id":"tools/babel-preset-metro-react-native","title":"babel-preset-metro-react-native","description":"Build","source":"@site/docs/tools/babel-preset-metro-react-native.md","sourceDirName":"tools","slug":"/tools/babel-preset-metro-react-native","permalink":"/rnx-kit/docs/tools/babel-preset-metro-react-native","draft":false,"unlisted":false,"editUrl":"https://github.com/microsoft/rnx-kit/tree/main/docsite/docs/tools/babel-preset-metro-react-native.md","tags":[],"version":"current","frontMatter":{},"sidebar":"toolsSidebar","previous":{"title":"babel-plugin-import-path-remapper","permalink":"/rnx-kit/docs/tools/babel-plugin-import-path-remapper"},"next":{"title":"bundle-diff","permalink":"/rnx-kit/docs/tools/bundle-diff"}}');var r=s(4848),o=s(8453);const a={},i="babel-preset-metro-react-native",l={},c=[{value:"Usage",id:"usage",level:2},{value:"Notes on Bundle Size",id:"notes-on-bundle-size",level:2},{value:"Enable compiler assumptions",id:"enable-compiler-assumptions",level:3},{value:"Enable loose mode when transforming classes",id:"enable-loose-mode-when-transforming-classes",level:3},{value:"Enable experimental import/export support",id:"enable-experimental-importexport-support",level:3},{value:"<code>babel-plugin-lodash</code>",id:"babel-plugin-lodash",level:3}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",p:"p",pre:"pre",...(0,o.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"babel-preset-metro-react-native",children:"babel-preset-metro-react-native"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.a,{href:"https://github.com/microsoft/rnx-kit/actions/workflows/build.yml",children:(0,r.jsx)(n.img,{src:"https://github.com/microsoft/rnx-kit/actions/workflows/build.yml/badge.svg",alt:"Build"})}),"\n",(0,r.jsx)(n.a,{href:"https://www.npmjs.com/package/@rnx-kit/babel-preset-metro-react-native",children:(0,r.jsx)(n.img,{src:"https://img.shields.io/npm/v/@rnx-kit/babel-preset-metro-react-native",alt:"npm version"})})]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"@rnx-kit/babel-preset-metro-react-native"})," provides a Babel preset for React\nNative applications that you can use as a drop-in replacement for\n",(0,r.jsx)(n.a,{href:"https://github.com/facebook/metro/tree/master/packages/metro-react-native-babel-preset",children:(0,r.jsx)(n.code,{children:"metro-react-native-babel-preset"})}),")."]}),"\n",(0,r.jsx)(n.h2,{id:"usage",children:"Usage"}),"\n",(0,r.jsxs)(n.p,{children:["Add ",(0,r.jsx)(n.code,{children:"@rnx-kit/babel-preset-metro-react-native"})," to your ",(0,r.jsx)(n.code,{children:"babel.config.js"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:'module.exports = {\n  presets: ["@rnx-kit/babel-preset-metro-react-native"],\n};\n'})}),"\n",(0,r.jsx)(n.p,{children:"If you want to add additional plugins, you can pass an options object:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:'module.exports = {\n  presets: [\n    [\n      "@rnx-kit/babel-preset-metro-react-native",\n      {\n        additionalPlugins: ["const-enum"],\n      },\n    ],\n  ],\n};\n'})}),"\n",(0,r.jsx)(n.h2,{id:"notes-on-bundle-size",children:"Notes on Bundle Size"}),"\n",(0,r.jsx)(n.p,{children:"If you're looking to reduce the bundle size, here are a couple of things you can\ntry."}),"\n",(0,r.jsx)(n.h3,{id:"enable-compiler-assumptions",children:"Enable compiler assumptions"}),"\n",(0,r.jsxs)(n.p,{children:["Since 7.13.0, Babel can make certain assumptions about your code to reduce the\namount of generated code. You can read more about it in\n",(0,r.jsx)(n.a,{href:"https://babeljs.io/docs/en/assumptions",children:"Compiler assumptions"}),"."]}),"\n",(0,r.jsx)(n.h3,{id:"enable-loose-mode-when-transforming-classes",children:"Enable loose mode when transforming classes"}),"\n",(0,r.jsxs)(n.p,{children:["If you make heavy use of classes, but can't use compiler assumptions, you can\nenable ",(0,r.jsx)(n.code,{children:"looseClassTransform"})," to remove helper functions:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:'module.exports = {\n  presets: [\n    [\n      "@rnx-kit/babel-preset-metro-react-native",\n      {\n        looseClassTransform: true,\n      },\n    ],\n  ],\n};\n'})}),"\n",(0,r.jsxs)(n.p,{children:["This is equivalent to passing\n",(0,r.jsx)(n.a,{href:"https://babeljs.io/docs/en/babel-plugin-transform-classes#loose",children:(0,r.jsx)(n.code,{children:"{ loose: true }"})}),"\nto ",(0,r.jsx)(n.code,{children:"@babel/plugin-transform-classes"}),"."]}),"\n",(0,r.jsx)(n.h3,{id:"enable-experimental-importexport-support",children:"Enable experimental import/export support"}),"\n",(0,r.jsxs)(n.p,{children:["In your ",(0,r.jsx)(n.code,{children:"metro.config.js"}),", enable ",(0,r.jsx)(n.code,{children:"experimentalImportSupport"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:"module.exports = {\n  transformer: {\n    getTransformOptions: async () => ({\n      transform: {\n        experimentalImportSupport: true,\n        inlineRequires: true,\n      },\n    }),\n  },\n};\n"})}),"\n",(0,r.jsxs)(n.p,{children:["And disable import/export transformation in your ",(0,r.jsx)(n.code,{children:"babel.config.js"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:'module.exports = {\n  presets: [\n    [\n      "@rnx-kit/babel-preset-metro-react-native",\n      { disableImportExportTransform: true },\n    ],\n  ],\n};\n'})}),"\n",(0,r.jsx)(n.p,{children:"Doing this will help the minifier strip out some unused code, but make sure that\nyour app still works after enabling it."}),"\n",(0,r.jsx)(n.h3,{id:"babel-plugin-lodash",children:(0,r.jsx)(n.code,{children:"babel-plugin-lodash"})}),"\n",(0,r.jsxs)(n.p,{children:["If you're using ",(0,r.jsx)(n.a,{href:"https://lodash.com",children:"Lodash"}),", you can get some reduction with\n",(0,r.jsx)(n.a,{href:"https://github.com/lodash/babel-plugin-lodash",children:"babel-plugin-lodash"}),". Add it to\nyour ",(0,r.jsx)(n.code,{children:"babel.config.js"})," like below:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:'module.exports = {\n  presets: ["@rnx-kit/babel-preset-metro-react-native"],\n  plugins: ["lodash"],\n};\n'})})]})}function p(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>a,x:()=>i});var t=s(6540);const r={},o=t.createContext(r);function a(e){const n=t.useContext(o);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),t.createElement(o.Provider,{value:n},e.children)}}}]);