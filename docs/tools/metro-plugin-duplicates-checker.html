<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-tools/metro-plugin-duplicates-checker" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.5.2">
<title data-rh="true">metro-plugin-duplicates-checker | React Native Developer Tools</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://microsoft.github.io/rnx-kit/docs/tools/metro-plugin-duplicates-checker"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="metro-plugin-duplicates-checker | React Native Developer Tools"><meta data-rh="true" name="description" content="Build"><meta data-rh="true" property="og:description" content="Build"><link data-rh="true" rel="icon" href="/rnx-kit/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://microsoft.github.io/rnx-kit/docs/tools/metro-plugin-duplicates-checker"><link data-rh="true" rel="alternate" href="https://microsoft.github.io/rnx-kit/docs/tools/metro-plugin-duplicates-checker" hreflang="en"><link data-rh="true" rel="alternate" href="https://microsoft.github.io/rnx-kit/docs/tools/metro-plugin-duplicates-checker" hreflang="x-default"><link rel="stylesheet" href="/rnx-kit/assets/css/styles.ef74adb2.css">
<script src="/rnx-kit/assets/js/runtime~main.3f2583c6.js" defer="defer"></script>
<script src="/rnx-kit/assets/js/main.4d83d500.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/rnx-kit/"><div class="navbar__logo"><img src="/rnx-kit/img/react-logo.svg" alt="react native logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/rnx-kit/img/react-logo.svg" alt="react native logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">rnx-kit</b></a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/rnx-kit/docs/introduction">Docs</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/rnx-kit/docs/tools/overview">Tools</a><a class="navbar__item navbar__link" href="/rnx-kit/docs/architecture/overview">Architecture</a><a class="navbar__item navbar__link" href="/rnx-kit/docs/community">Community</a><a class="navbar__item navbar__link" href="/rnx-kit/docs/contributing">Contributing</a><a href="https://devblogs.microsoft.com/react-native/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Blog<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://github.com/microsoft/rnx-kit/#readme" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link github-mark-24px" src="img/github-logo.svg" aria-label="GitHub repository"></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="navbar__search"><span aria-label="expand searchbar" role="button" class="search-icon" tabindex="0"></span><input id="search_input_react" type="search" placeholder="Loading..." aria-label="Search" class="navbar__search-input search-bar" disabled=""></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/rnx-kit/docs/tools/overview">Tools</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rnx-kit/docs/tools/overview">Tools Overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rnx-kit/docs/tools/align-deps">align-deps</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rnx-kit/docs/tools/babel-plugin-import-path-remapper">babel-plugin-import-path-remapper</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rnx-kit/docs/tools/babel-preset-metro-react-native">babel-preset-metro-react-native</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rnx-kit/docs/tools/bundle-diff">bundle-diff</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rnx-kit/docs/tools/cli">cli</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rnx-kit/docs/tools/config">config</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rnx-kit/docs/tools/console">console</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rnx-kit/docs/tools/esbuild-plugin-import-path-remapper">esbuild-plugin-import-path-remapper</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rnx-kit/docs/tools/eslint-plugin">eslint-plugin</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rnx-kit/docs/tools/jest-preset">jest-preset</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rnx-kit/docs/tools/metro-config">metro-config</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rnx-kit/docs/tools/metro-plugin-cyclic-dependencies-detector">metro-plugin-cyclic-dependencies-detector</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/rnx-kit/docs/tools/metro-plugin-duplicates-checker">metro-plugin-duplicates-checker</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rnx-kit/docs/tools/metro-plugin-typescript">metro-plugin-typescript</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rnx-kit/docs/tools/metro-resolver-symlinks">metro-resolver-symlinks</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rnx-kit/docs/tools/metro-serializer">metro-serializer</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rnx-kit/docs/tools/metro-serializer-esbuild">metro-serializer-esbuild</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rnx-kit/docs/tools/react-native-auth">react-native-auth</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rnx-kit/docs/tools/react-native-host">react-native-host</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rnx-kit/docs/tools/react-native-lazy-index">react-native-lazy-index</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rnx-kit/docs/tools/third-party-notices">third-party-notices</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rnx-kit/docs/tools/tools-android">tools-android</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rnx-kit/docs/tools/tools-apple">tools-apple</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rnx-kit/docs/tools/tools-language">tools-language</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rnx-kit/docs/tools/tools-node">tools-node</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rnx-kit/docs/tools/tools-react-native">tools-react-native</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rnx-kit/docs/tools/tools-shell">tools-shell</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rnx-kit/docs/tools/tools-windows">tools-windows</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rnx-kit/docs/tools/tools-workspaces">tools-workspaces</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rnx-kit/docs/tools/tsconfig">tsconfig</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rnx-kit/docs/tools/typescript-service">typescript-service</a></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>metro-plugin-duplicates-checker</h1></header>
<p><a href="https://github.com/microsoft/rnx-kit/actions/workflows/build.yml" target="_blank" rel="noopener noreferrer"><img decoding="async" loading="lazy" src="https://github.com/microsoft/rnx-kit/actions/workflows/build.yml/badge.svg" alt="Build" class="img_ev3q"></a>
<a href="https://www.npmjs.com/package/@rnx-kit/metro-plugin-duplicates-checker" target="_blank" rel="noopener noreferrer"><img decoding="async" loading="lazy" src="https://img.shields.io/npm/v/@rnx-kit/metro-plugin-duplicates-checker" alt="npm version" class="img_ev3q"></a></p>
<p><code>@rnx-kit/metro-plugin-duplicates-checker</code> checks for duplicate packages in your
bundle.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="usage">Usage<a href="#usage" class="hash-link" aria-label="Direct link to Usage" title="Direct link to Usage">​</a></h2>
<p>There are several ways to use this package.</p>
<p>The <strong>recommended</strong> way is to add it as a plugin in your <code>metro.config.js</code> using
<code>@rnx-kit/metro-serializer</code>:</p>
<div class="language-diff codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:rgb(28, 30, 33);--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-diff codeBlock_bY9V thin-scrollbar" style="color:rgb(28, 30, 33);background-color:#ffffff"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:rgb(28, 30, 33)"><span class="token plain"> const { makeMetroConfig } = require(&quot;@rnx-kit/metro-config&quot;);</span><br></span><span class="token-line" style="color:rgb(28, 30, 33)"><span class="token plain">+const {</span><br></span><span class="token-line" style="color:rgb(28, 30, 33)"><span class="token plain">+  DuplicateDependencies,</span><br></span><span class="token-line" style="color:rgb(28, 30, 33)"><span class="token plain">+} = require(&quot;@rnx-kit/metro-plugin-duplicates-checker&quot;);</span><br></span><span class="token-line" style="color:rgb(28, 30, 33)"><span class="token plain">+const { MetroSerializer } = require(&quot;@rnx-kit/metro-serializer&quot;);</span><br></span><span class="token-line" style="color:rgb(28, 30, 33)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:rgb(28, 30, 33)"><span class="token plain"> module.exports = makeMetroConfig({</span><br></span><span class="token-line" style="color:rgb(28, 30, 33)"><span class="token plain">   serializer: {</span><br></span><span class="token-line" style="color:rgb(28, 30, 33)"><span class="token plain">+    customSerializer: MetroSerializer([DuplicateDependencies()]),</span><br></span><span class="token-line" style="color:rgb(28, 30, 33)"><span class="token plain">   },</span><br></span><span class="token-line" style="color:rgb(28, 30, 33)"><span class="token plain"> });</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>You can also check for duplicate packages after a bundle is created:</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:rgb(28, 30, 33);--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="color:rgb(28, 30, 33);background-color:#ffffff"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:rgb(28, 30, 33)"><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:rgb(28, 30, 33)"><span class="token plain">  checkForDuplicatePackagesInFile</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:rgb(28, 30, 33)"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">require</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;@rnx-kit/metro-plugin-duplicates-checker&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:rgb(28, 30, 33)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:rgb(28, 30, 33)"><span class="token plain"></span><span class="token function" style="color:rgb(0, 0, 255)">checkForDuplicatePackagesInFile</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">pathToSourceMapFile</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:rgb(28, 30, 33)"><span class="token plain">  </span><span class="token literal-property property">ignoredModules</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:rgb(28, 30, 33)"><span class="token plain">  </span><span class="token literal-property property">bannedModules</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:rgb(28, 30, 33)"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>If you have a source map object, you can pass that directly to
<code>checkForDuplicatePackages()</code>:</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:rgb(28, 30, 33);--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="color:rgb(28, 30, 33);background-color:#ffffff"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:rgb(28, 30, 33)"><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:rgb(28, 30, 33)"><span class="token plain">  checkForDuplicatePackages</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:rgb(28, 30, 33)"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">require</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;@rnx-kit/metro-plugin-duplicates-checker&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:rgb(28, 30, 33)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:rgb(28, 30, 33)"><span class="token plain"></span><span class="token function" style="color:rgb(0, 0, 255)">checkForDuplicatePackages</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">mySourceMap</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:rgb(28, 30, 33)"><span class="token plain">  </span><span class="token literal-property property">ignoredModules</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:rgb(28, 30, 33)"><span class="token plain">  </span><span class="token literal-property property">bannedModules</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:rgb(28, 30, 33)"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="options">Options<a href="#options" class="hash-link" aria-label="Direct link to Options" title="Direct link to Options">​</a></h2>
<table><thead><tr><th style="text-align:left">Key</th><th style="text-align:left">Type</th><th style="text-align:left">Default</th><th style="text-align:left">Description</th></tr></thead><tbody><tr><td style="text-align:left">bannedModules</td><td style="text-align:left">string[]</td><td style="text-align:left"><code>[]</code></td><td style="text-align:left">List of modules that are banned.</td></tr><tr><td style="text-align:left">ignoredModules</td><td style="text-align:left">string[]</td><td style="text-align:left"><code>[]</code></td><td style="text-align:left">List of modules that can be ignored.</td></tr><tr><td style="text-align:left">throwOnError</td><td style="text-align:left">boolean</td><td style="text-align:left"><code>true</code></td><td style="text-align:left">Whether to throw when duplicates are found.</td></tr></tbody></table>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="resolving-duplicates">Resolving Duplicates<a href="#resolving-duplicates" class="hash-link" aria-label="Direct link to Resolving Duplicates" title="Direct link to Resolving Duplicates">​</a></h2>
<p>So you have duplicates in your bundle, now what? Depending on your specific
needs, we have several options.</p>
<p>Let&#x27;s use a specific example:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:rgb(28, 30, 33);--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:rgb(28, 30, 33);background-color:#ffffff"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:rgb(28, 30, 33)"><span class="token plain">error @fluentui-react-native/text (found 2 copies)</span><br></span><span class="token-line" style="color:rgb(28, 30, 33)"><span class="token plain">warn   0.21.14 /~/node_modules/@fluentui-react-native/text</span><br></span><span class="token-line" style="color:rgb(28, 30, 33)"><span class="token plain">warn   0.22.7 /~/node_modules/@fluentui-react-native/link/node_modules/@fluentui-react-native/text</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>This one occurs because <code>@fluentui-react-native/link</code> declares a dependency on
<code>@fluentui-react-native/text</code> using a wide version range, <code>&gt;=0.21.14 &lt;1.0.0</code>.</p>
<p>Our project depends on <code>@fluentui-react-native/text@^0.21.14</code>, but package
managers will typically still try to resolve <code>&gt;=0.21.14 &lt;1.0.0</code> instead of using
the existing resolution. This results in the duplicate error we see above.</p>
<p>From here, we have several options:</p>
<ul>
<li><a href="#manual-dedupe">Manual Dedupe</a></li>
<li><a href="#using-tools">Using Tools</a></li>
<li><a href="#help-metro-resolve-correct-version">Help Metro Resolve Correct Version</a></li>
<li><a href="#last-resort-force-resolution">Last Resort: Force Resolution</a></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="manual-dedupe">Manual Dedupe<a href="#manual-dedupe" class="hash-link" aria-label="Direct link to Manual Dedupe" title="Direct link to Manual Dedupe">​</a></h3>
<p>This method is error-prone, especially if you have a lot of duplicates. It works
if you have very few entries. It varies a lot depending on the package manager
you&#x27;re using.</p>
<p>The project in our example uses Yarn Classic: Open <code>yarn.lock</code> and look for
<code>@fluentui-react-native/text</code>:</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:rgb(28, 30, 33);--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:rgb(28, 30, 33);background-color:#ffffff"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:rgb(28, 30, 33)"><span class="token plain">&quot;@fluentui</span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain">react</span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain">native/text@0.21.14&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token key atrule">&quot;@fluentui-react-native/text@^0.21.14&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:rgb(28, 30, 33)"><span class="token plain">  version &quot;0.21.14&quot;</span><br></span><span class="token-line" style="color:rgb(28, 30, 33)"><span class="token plain">  resolved &quot;https</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain">//registry.yarnpkg.com/@fluentui</span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain">react</span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain">native/text/</span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain">/text</span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain">0.21.14.tgz</span><span class="token comment" style="color:rgb(0, 128, 0)">#04918a9558770ec551cbdac87ca1534bfccaeffb&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:rgb(28, 30, 33)"><span class="token plain">  integrity sha1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain">BJGKlVh3DsVRy9rIfKFTS/zK7/s=</span><br></span><span class="token-line" style="color:rgb(28, 30, 33)"><span class="token plain">  </span><span class="token key atrule">dependencies</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:rgb(28, 30, 33)"><span class="token plain">    &quot;@fluentui</span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain">react</span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain">native/adapters&quot; &quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain">=0.11.3 &lt;1.0.0&quot;</span><br></span><span class="token-line" style="color:rgb(28, 30, 33)"><span class="token plain">    &quot;@fluentui</span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain">react</span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain">native/framework&quot; &quot;0.11.10&quot;</span><br></span><span class="token-line" style="color:rgb(28, 30, 33)"><span class="token plain">    &quot;@fluentui</span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain">react</span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain">native/interactive</span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain">hooks&quot; &quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain">=0.24.12 &lt;1.0.0&quot;</span><br></span><span class="token-line" style="color:rgb(28, 30, 33)"><span class="token plain">    &quot;@fluentui</span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain">react</span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain">native/theme</span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain">tokens&quot; &quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain">=0.25.4 &lt;1.0.0&quot;</span><br></span><span class="token-line" style="color:rgb(28, 30, 33)"><span class="token plain">    &quot;@fluentui</span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain">react</span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain">native/tokens&quot; &quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain">=0.21.6 &lt;1.0.0&quot;</span><br></span><span class="token-line" style="color:rgb(28, 30, 33)"><span class="token plain">    &quot;@uifabricshared/foundation</span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain">compose&quot; &quot;^1.14.12&quot;</span><br></span><span class="token-line" style="color:rgb(28, 30, 33)"><span class="token plain">    tslib &quot;^2.3.1&quot;</span><br></span><span class="token-line" style="color:rgb(28, 30, 33)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:rgb(28, 30, 33)"><span class="token plain"></span><span class="token key atrule">&quot;@fluentui-react-native/text@&gt;=0.21.14 &lt;1.0.0&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:rgb(28, 30, 33)"><span class="token plain">  version &quot;0.22.7&quot;</span><br></span><span class="token-line" style="color:rgb(28, 30, 33)"><span class="token plain">  resolved &quot;https</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain">//registry.yarnpkg.com/@fluentui</span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain">react</span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain">native/text/</span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain">/text</span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain">0.22.7.tgz</span><span class="token comment" style="color:rgb(0, 128, 0)">#bd11768d3cd69337ad2ec4be76ee88d6749ca24f&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:rgb(28, 30, 33)"><span class="token plain">  integrity sha1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain">vRF2jTzWkzetLsS+du6I1nScok8=</span><br></span><span class="token-line" style="color:rgb(28, 30, 33)"><span class="token plain">  </span><span class="token key atrule">dependencies</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:rgb(28, 30, 33)"><span class="token plain">    &quot;@fluentui</span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain">react</span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain">native/adapters&quot; &quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain">=0.12.0 &lt;1.0.0&quot;</span><br></span><span class="token-line" style="color:rgb(28, 30, 33)"><span class="token plain">    &quot;@fluentui</span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain">react</span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain">native/framework&quot; &quot;0.13.6&quot;</span><br></span><span class="token-line" style="color:rgb(28, 30, 33)"><span class="token plain">    &quot;@fluentui</span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain">react</span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain">native/interactive</span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain">hooks&quot; &quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain">=0.25.7 &lt;1.0.0&quot;</span><br></span><span class="token-line" style="color:rgb(28, 30, 33)"><span class="token plain">    &quot;@fluentui</span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain">react</span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain">native/theme</span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain">tokens&quot; &quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain">=0.26.5 &lt;1.0.0&quot;</span><br></span><span class="token-line" style="color:rgb(28, 30, 33)"><span class="token plain">    &quot;@fluentui</span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain">react</span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain">native/tokens&quot; &quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain">=0.22.5 &lt;1.0.0&quot;</span><br></span><span class="token-line" style="color:rgb(28, 30, 33)"><span class="token plain">    &quot;@uifabricshared/foundation</span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain">compose&quot; &quot;^1.14.20&quot;</span><br></span><span class="token-line" style="color:rgb(28, 30, 33)"><span class="token plain">    tslib &quot;^2.3.1&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>We can see there are two entries, one being resolved to 0.21.14 and the other to
0.22.7. In this case, since we want to keep 0.21.x and the version ranges just
happens to be satisfied by this. We can merge the two entries like below:</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:rgb(28, 30, 33);--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:rgb(28, 30, 33);background-color:#ffffff"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:rgb(28, 30, 33)"><span class="token plain">&quot;@fluentui</span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain">react</span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain">native/text@0.21.14&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;@fluentui-react-native/text@&gt;=0.21.14 &lt;1.0.0&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token key atrule">&quot;@fluentui-react-native/text@^0.21.14&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:rgb(28, 30, 33)"><span class="token plain">  version &quot;0.21.14&quot;</span><br></span><span class="token-line" style="color:rgb(28, 30, 33)"><span class="token plain">  resolved &quot;https</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain">//registry.yarnpkg.com/@fluentui</span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain">react</span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain">native/text/</span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain">/text</span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain">0.21.14.tgz</span><span class="token comment" style="color:rgb(0, 128, 0)">#04918a9558770ec551cbdac87ca1534bfccaeffb&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:rgb(28, 30, 33)"><span class="token plain">  integrity sha1</span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain">BJGKlVh3DsVRy9rIfKFTS/zK7/s=</span><br></span><span class="token-line" style="color:rgb(28, 30, 33)"><span class="token plain">  </span><span class="token key atrule">dependencies</span><span class="token punctuation" style="color:rgb(4, 81, 165)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:rgb(28, 30, 33)"><span class="token plain">    &quot;@fluentui</span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain">react</span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain">native/adapters&quot; &quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain">=0.11.3 &lt;1.0.0&quot;</span><br></span><span class="token-line" style="color:rgb(28, 30, 33)"><span class="token plain">    &quot;@fluentui</span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain">react</span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain">native/framework&quot; &quot;0.11.10&quot;</span><br></span><span class="token-line" style="color:rgb(28, 30, 33)"><span class="token plain">    &quot;@fluentui</span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain">react</span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain">native/interactive</span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain">hooks&quot; &quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain">=0.24.12 &lt;1.0.0&quot;</span><br></span><span class="token-line" style="color:rgb(28, 30, 33)"><span class="token plain">    &quot;@fluentui</span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain">react</span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain">native/theme</span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain">tokens&quot; &quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain">=0.25.4 &lt;1.0.0&quot;</span><br></span><span class="token-line" style="color:rgb(28, 30, 33)"><span class="token plain">    &quot;@fluentui</span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain">react</span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain">native/tokens&quot; &quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain">=0.21.6 &lt;1.0.0&quot;</span><br></span><span class="token-line" style="color:rgb(28, 30, 33)"><span class="token plain">    &quot;@uifabricshared/foundation</span><span class="token punctuation" style="color:rgb(4, 81, 165)">-</span><span class="token plain">compose&quot; &quot;^1.14.12&quot;</span><br></span><span class="token-line" style="color:rgb(28, 30, 33)"><span class="token plain">    tslib &quot;^2.3.1&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Now we should only have one copy of <code>@fluentui-react-native/text</code>.</p>
<p>Our example is relatively simple. Sometimes you have to go further up the
dependency chain and dedupe dependees.</p>
<p>Fortunately, we can use tools in most cases.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="using-tools">Using Tools<a href="#using-tools" class="hash-link" aria-label="Direct link to Using Tools" title="Direct link to Using Tools">​</a></h3>
<p>If you&#x27;re using Yarn Classic, there is a tool, <a href="https://github.com/scinos/yarn-deduplicate" target="_blank" rel="noopener noreferrer"><code>yarn-deduplicate</code></a>, for
deduplicating everything in <code>yarn.lock</code>. You can run it like so:</p>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:rgb(28, 30, 33);--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:rgb(28, 30, 33);background-color:#ffffff"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:rgb(28, 30, 33)"><span class="token plain">npx yarn-deduplicate</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>By default, it will try to dedupe to the highest version. In our example,
however, we want to keep using 0.21.x. We should also limit the number of
packages that get deduped to make it easier to review later. <code>yarn-deduplicate</code>
provides many options, but we&#x27;ll be using the <code>fewer</code> strategy and the
<code>--scopes</code> flag to only target <code>@fluentui-react-native</code> packages:</p>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:rgb(28, 30, 33);--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:rgb(28, 30, 33);background-color:#ffffff"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:rgb(28, 30, 33)"><span class="token plain">npx yarn-deduplicate --strategy fewer --scopes @fluentui-react-native</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>You can read more about <code>yarn-deduplicate</code> and available options here:
<a href="https://github.com/scinos/yarn-deduplicate#readme" target="_blank" rel="noopener noreferrer">https://github.com/scinos/yarn-deduplicate#readme</a></p>
<p>If you&#x27;re using modern Yarn or other package managers, check out their built-in
dedupe command:</p>
<ul>
<li><strong>Yarn:</strong> <a href="https://yarnpkg.com/cli/dedupe" target="_blank" rel="noopener noreferrer">https://yarnpkg.com/cli/dedupe</a></li>
<li><strong>npm:</strong> <a href="https://docs.npmjs.com/cli/commands/npm-dedupe" target="_blank" rel="noopener noreferrer">https://docs.npmjs.com/cli/commands/npm-dedupe</a></li>
<li><strong>pnpm:</strong> <a href="https://pnpm.io/cli/dedupe" target="_blank" rel="noopener noreferrer">https://pnpm.io/cli/dedupe</a></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="help-metro-resolve-correct-version">Help Metro Resolve Correct Version<a href="#help-metro-resolve-correct-version" class="hash-link" aria-label="Direct link to Help Metro Resolve Correct Version" title="Direct link to Help Metro Resolve Correct Version">​</a></h3>
<p>If, for some reason, you cannot dedupe the package, you can instead configure
Metro to resolve the correct version by telling it which version to use (with
<a href="https://metrobundler.dev/docs/configuration/#extranodemodules" target="_blank" rel="noopener noreferrer"><code>resolver.extraNodeModules</code></a>) and blocking every other copy (with
<a href="https://metrobundler.dev/docs/configuration/#blocklist" target="_blank" rel="noopener noreferrer"><code>resolver.blockList</code></a>):</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:rgb(28, 30, 33);--prism-background-color:#ffffff"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="color:rgb(28, 30, 33);background-color:#ffffff"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:rgb(28, 30, 33)"><span class="token plain">module</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token property-access">exports</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:rgb(28, 30, 33)"><span class="token plain">  </span><span class="token literal-property property">resolver</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:rgb(28, 30, 33)"><span class="token plain">    </span><span class="token literal-property property">extraNodeModules</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:rgb(28, 30, 33)"><span class="token plain">      </span><span class="token string-property property">&quot;@fluentui-react-native/text&quot;</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:rgb(28, 30, 33)"><span class="token plain">        </span><span class="token string" style="color:rgb(163, 21, 21)">&quot;/~/my-project/node_modules/@fluentui-react-native/text&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:rgb(28, 30, 33)"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:rgb(28, 30, 33)"><span class="token plain">    </span><span class="token literal-property property">blockList</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:rgb(28, 30, 33)"><span class="token plain">      </span><span class="token regex regex-delimiter">/</span><span class="token regex regex-source language-regex group punctuation" style="color:rgb(4, 81, 165)">(?&lt;!</span><span class="token regex regex-source language-regex escape">\/</span><span class="token regex regex-source language-regex">~</span><span class="token regex regex-source language-regex escape">\/</span><span class="token regex regex-source language-regex">my-project</span><span class="token regex regex-source language-regex group punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token regex regex-source language-regex escape">\/</span><span class="token regex regex-source language-regex">node_modules</span><span class="token regex regex-source language-regex escape">\/</span><span class="token regex regex-source language-regex">@fluentui-react-native</span><span class="token regex regex-source language-regex escape">\/</span><span class="token regex regex-source language-regex">text</span><span class="token regex regex-source language-regex escape">\/</span><span class="token regex regex-source language-regex char-set class-name" style="color:rgb(38, 127, 153)">.</span><span class="token regex regex-source language-regex quantifier number" style="color:rgb(9, 134, 88)">*</span><span class="token regex regex-delimiter">/</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:rgb(28, 30, 33)"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:rgb(28, 30, 33)"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:rgb(28, 30, 33)"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>You don&#x27;t have to write these entries manually. We have helper functions in
<a href="https://github.com/microsoft/rnx-kit/blob/main/packages/metro-config/README.md#ensuring-a-single-instance-of-a-package" target="_blank" rel="noopener noreferrer"><code>@rnx-kit/metro-config</code></a> for generating them dynamically.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="last-resort-force-resolution">Last Resort: Force Resolution<a href="#last-resort-force-resolution" class="hash-link" aria-label="Direct link to Last Resort: Force Resolution" title="Direct link to Last Resort: Force Resolution">​</a></h3>
<p>As a last resort, if everything else fails, you can manually override package
resolutions. We don&#x27;t recommend this solution because it forces a single version
in all workspaces. For example, if you have two projects that have nothing to do
with each other, they will both be forced to use the same version even though
they could be using different versions. It also adds maintenance overhead
because you will have to manually update the version as dependees update theirs.</p>
<p>If you&#x27;ve decided that you have no other options, you can find the appropriate
documentation for your package manager below:</p>
<ul>
<li><strong>Yarn:</strong> <a href="https://yarnpkg.com/configuration/manifest#resolutions" target="_blank" rel="noopener noreferrer">https://yarnpkg.com/configuration/manifest#resolutions</a></li>
<li><strong>npm:</strong> <a href="https://docs.npmjs.com/cli/v10/configuring-npm/package-json#overrides" target="_blank" rel="noopener noreferrer">https://docs.npmjs.com/cli/v10/configuring-npm/package-json#overrides</a></li>
<li><strong>pnpm:</strong> <a href="https://pnpm.io/package_json#pnpmoverrides" target="_blank" rel="noopener noreferrer">https://pnpm.io/package_json#pnpmoverrides</a></li>
</ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/microsoft/rnx-kit/tree/main/docsite/docs/tools/metro-plugin-duplicates-checker.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/rnx-kit/docs/tools/metro-plugin-cyclic-dependencies-detector"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">metro-plugin-cyclic-dependencies-detector</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/rnx-kit/docs/tools/metro-plugin-typescript"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">metro-plugin-typescript</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#usage" class="table-of-contents__link toc-highlight">Usage</a></li><li><a href="#options" class="table-of-contents__link toc-highlight">Options</a></li><li><a href="#resolving-duplicates" class="table-of-contents__link toc-highlight">Resolving Duplicates</a><ul><li><a href="#manual-dedupe" class="table-of-contents__link toc-highlight">Manual Dedupe</a></li><li><a href="#using-tools" class="table-of-contents__link toc-highlight">Using Tools</a></li><li><a href="#help-metro-resolve-correct-version" class="table-of-contents__link toc-highlight">Help Metro Resolve Correct Version</a></li><li><a href="#last-resort-force-resolution" class="table-of-contents__link toc-highlight">Last Resort: Force Resolution</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="margin-bottom--sm"><a href="https://opensource.microsoft.com" rel="noopener noreferrer" class="footerLogoLink_BH7S"><img src="/rnx-kit/img/msoss-light.png" alt="Microsoft Open Source logo" class="footer__logo themedComponent_mlkZ themedComponent--light_NVdE"><img src="/rnx-kit/img/msoss-dark.png" alt="Microsoft Open Source logo" class="footer__logo themedComponent_mlkZ themedComponent--dark_xIcU"></a></div><div class="footer__copyright">Copyright © 2025 Microsoft</div></div></div></footer></div>
</body>
</html>